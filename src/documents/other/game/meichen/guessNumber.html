<!DOCTYPE HTML>
<html>
  <head>
    <style type="text/css">
      div {display:block;font-size:small;}
      #tip {margin-bottom: 30px;}
      #console {color:#1e0fbe;}
      #input {margin-top: 8px;}
    </style>
  </head>
  <body>
    <div id="tip">
      <div>WELCOME to Meichen's game replicated from one of her Childhood favourites!</div>
      <div>    This game is about guessing a 4 digits number, </div>
      <div>    each digit ranges from 0 to 9 while each is unique</div>
      <div>    Each time you have made a guess, the feedback would lead you to the next step by showing XAYB. </div>
      <div>    XA means that you got X numbers of right numbers at the right position.</div>
      <div>    YB means that you have Y numbers are the right numbers at wrong position! </div>
      <div>    For example, the right one is 1234 so the guess 1832 would give you 2A1B. </div>
      <div>There would be 10 chances in total ;)</div>
      <div>Now try it yourself :D</div>
    </div>
    <div id="console"></div>
    <div id="input">
      <input id="userinput" type="text"/>
    </div>
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.10.2.min.js" ></script>
    <script type="text/javascript" src="./guessNumber.js" ></script>
    <script type="text/javascript" >
      (function($){
       var globalGuess = null;
       var gm = new guessGame.GM();
       var RETRY_NUM = 11;
       var retry = RETRY_NUM;

       var log = function(text) {
         $("#console").append("<div >" + text + "</div>");
       };

       $("#userinput")
         .attr("maxlength", guessGame.Guess.INPUT_LEN)
         .keyup(function(){
            var text = $("#userinput").val();
            if (guessGame.Guess.INPUT_LEN > text.length) {
              return;
            }

            if (RETRY_NUM == retry) {
                $("#console").html("");
            }
            retry --;
            if (!globalGuess) {
              globalGuess = new guessGame.Guess(text);
            } else {
              globalGuess.num = text;
            }

            var ret = gm.play(globalGuess);
            switch(ret) {
              case guessGame.GM.TRY_AGAIN:
                if (0 < retry) {
                  log(text + ": " + globalGuess.result.A + "A" + globalGuess.result.B + "B");
                } else  {
                  $("#console").html("");
                  log("Sorry, the true answer is '" +
                    globalGuess.answer.join("") +
                    "'<br/>I am sure u can get it right next time XD");
                  globalGuess = null;
                  retry = RETRY_NUM;
                }
                break;
              case guessGame.GM.HIT :
                $("#console").html("");
                log(text + ". That is it. You're a GENIUS!!! Congratulations!");
                globalGuess = null;
                retry = RETRY_NUM;
                break;
              default:
                log("Input format Error for '" + text + "'");
                retry ++;
                break;
            }
            $("#userinput").val("");

         });
      })(jQuery);
    </script>
  </body>
</html>
